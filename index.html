<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/x-icon" href="icons/pegaraw.jpg">
  <title>Sansinukob</title>
<style>

  :root{
      /* Palette */
      --ink-1:#0b1220;
      --ink-2:#ffd789;
      --ink-3:#121a2a;
      --ink-4:#3f0f08;

      --sun-1:#ecac22;
      --sun-2:#f0bc40;
      --sun-3:#fae792;

      --accent:#e27a3e;
      --text-on-dark:#e6edf3;
      --text-on-sun:#0a0a23;

      /* Radii & spacing */
      --r-1:8px;
      --r-2:4px;
      --gap-1:.5rem;
      --gap-2:1rem;
      --gap-3:2rem;

      /* Shadows */
      --shadow-1:0 2px 4px rgba(0,0,0,.2);
    }
    
      .timer {
      background:
        linear-gradient(rgba(0,0,0,.35), rgba(0,0,0,.35)),
        url("/elements/bg2.png");
      background-size:cover;
      background-position: top center;
      padding: 2rem 4vw 4rem;
      min-height: 100vh;
      box-shadow: var(--shadow-1);
    }
    .counter-disp{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      min-height: 68vh;
      background-image: url("icons/timerbg.png");
      background-repeat:no-repeat;
      background-position: top center;
      background-size: contain;
      padding-top: clamp(10vh, 15vh, 20vh);
      gap:.25rem;
    }

    #counter{
      font-family: "PanasChill", "Golden Age Mini", ui-serif, Georgia, serif;
      font-size: clamp(56px, 14vw, 160px);
      color: var(--accent);
      margin: 0 0 .25rem;
      text-shadow: 0 1px 0 rgba(0,0,0,.25);
    }

    #modeLabel{
      font-family: "Golden Age Mini", "Golden Age", ui-serif, Georgia, serif;
      font-size: clamp(14px, 3.2vw, 22px);
      color: var(--accent);
      letter-spacing:.06em;
      opacity:.95;
    }

    .controls{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      justify-content:center;
      margin: var(--gap-2) auto;
    }

    button{
      background: none;       /* remove background */
      border: none;           /* remove border */
      padding: 0;             /* remove extra spacing */
      cursor: pointer;
      transition: opacity 0.2s ease;
    }
    button:hover img {
      opacity: 0.8;  /* slightly dim on hover */
    }
    button:active img {
      opacity: 0.5;  /* translucent when clicked */
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(4, minmax(140px,1fr));
      gap:8px;
      max-width: min(960px, 96vw);
      height: 40px;
      margin: 0 auto;
    }

    .grid input{
      width:100%;
      padding:.6rem .8rem;
      border-radius: var(--r-2);
      border:1px solid var(--ink-4);
      background: var(--ink-2);
      outline:none;
      
    }

    .settings{
      white-space:pre-line;
      background: var(--ink-2);
      padding:.8rem 1rem;
      border-radius: var(--r-2);
      border:1px solid var(--ink-4);
      max-width: min(960px, 96vw);
      margin: .5rem auto 0;
      color: white;
      opacity:.9;
    }
    .growth-wrap{
      margin-top:1rem; display:grid; place-items:center; gap:.35rem;
   }

    .placeholder{
      color: var(--accent);
      font-family: "PanasChill";
      font-size: 20px;
      align-items: center;
      white-space: pre-wrap;
      min-height: 100px;
    }

      .placeholder::placeholder{
        color: var(--accent);
        font-family: "PanasChill";
        font-size: .9rem;
        margin: 1rem;
        white-space: pre-wrap;
        margin: auto;
        margin-top: 1px;
    }

    .flowerDisplay{ display:grid; place-items:center; gap:.5rem; margin-top:.25rem; }
    #growthFlower { height: 20vh; margin-left: auto; }
    progress { width: 320px; height: 16px; }
   
    .pomobuttons{
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      position: relative;
    }
    
    .btn-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-family: "PanasChill";
      font-size: 14px;
      color: #e27a3e;
      pointer-events: none;
}

</style>
  
</head>
<body>

<div class="titlescreen">
  <div class="gif"><img src="elements/gif.gif" alt="titlescreen gif"></div>
<div id="logo">
  <img src="icons/logo.png" alt="Logo">
</div>
    <div class="container">
  <a class="btn" href="#timer">
    <img src="icons/start.png" alt="Start Button">
  </a>
  <a href="#about" class="btn">
    <img src="icons/about.png" alt="About Button">
  </a>
  </div>
</div>


  </div>

  <div class="image-overlay-wrapper">
  <img src="icons/tree.png" alt="tree" class="top-image1">
   <img src="icons/cat.png" alt="cat" class="top-image2">
</div>

<a id="about"></a>
  <div class="about">
  <img src="icons/about-header1.png" alt="About Header"  id="about-header1">


  <div id="about-header2">
    <img src="icons/about-header2.png" alt="About Header2" >
  </div>

  <p>
    As a farmer, your goal is to stay productive while harvesting a variety of plants each day. Each study session helps your plants grow, and every plant has its own growth time before it can be harvested. As you progress, you’ll unlock rarer plants to grow and collect. Take on the challenge, accomplish your tasks, and build a flourishing collection!
  </p>

  <hr/>

   <div id="about-header2">
    <img src="icons/about-header3.png" alt="About Header2" >
  </div>

<hr/>
  

  <p>
    Sansinukob is a nonprofit Pomodoro timer website and farming simulator heavily inspired by Stardew Valley. It features pixelated native and genetically modified plants from UPLB’s Makiling Botanic Garden (e.g., Mussaenda philippica). It serves as an official entry to the CodeSprout 2025 Hackathon developed by UPLB BS Computer Science students. Special acknowledgement is given to Stardew Valley for being the primary creative inspiration behind the project.
  </p>

</div>

  <a id="timer"></a>
<div class="timer">
  <div class="menu">
 

  
    <div class="counter-disp">
    <h1 id="counter" >25:00</h1>
    <h3 class="mode" id="modeLabel"> UNDER DEVELOPMENT </h3>

  </div>

  </div>
<div class="controls">
  <button class="pomobuttons" id="start-btn">
    <img src="/elements/button.png" style="width: 100%; height: 100%;">
    <span class="btn-text">Start</span>
  </button>

  <button class="pomobuttons" id="pause-btn">
    <img id="pause-icon" src="/elements/button.png" style="width: 100%; height: 100%;">
    <span class="btn-text" id="pause-label">Pause</span>
  </button>

  <button class="pomobuttons" id="reset-btn">
    <img src="/elements/button.png" style="width: 100%; height: 100%;">
    <span class="btn-text">Reset</span>
  </button>
</div>

  <div class="grid">
      <input type="number" class="placeholder" id="worktime" min="0" placeholder="How long do want to work?" />
      <input type="number" class="placeholder" id="sBreak"  min="0" placeholder="Short breaks for how long?" />
      <input type="number" class="placeholder" id="lBreak"  min="0" placeholder="Long breaks for how long?" />
      <input type="number" class="placeholder" id="bMaxCounter" min="1" placeholder="How many short break do you want to have before getting a long break?" />
    </div>

     <div class="growth-wrap">
          <img id="growthFlower" alt="Growth Flower" />
          <div id="growthLabel" style="opacity:.85;font-size:.95rem;"></div>
        </div>

       <div class="controls">
      <button id="set-btn">Apply Settings</button>
    </div>
      <div class="settings" id="timeSet">—</div>

      <img id="flowerImg" alt="Flower" />
   <div class="flowerDisplay">
      <img id="growthFlower" alt="Flower growth" />
      <progress id="progressbar" max="100" value="0"></progress>
      <div id="flowerEta">--</div>
    </div>

</body>

<script>
  const flowerData = [
    {
    name: "Santan",
    growthTime: "750",
    lockedDesc: "Where purity lingers in the air.",
    fullDesc: "Flame of the Woods - ahh yes, this is what Filipino children used to sip for that one drop of sweetness—pure playground treasure.",
    iconState1: "sprites/SAMPAGUITA/sam1.png",
    iconState2: "sprites/SAMPAGUITA/sam2.png",
    iconState3: "sprites/SAMPAGUITA/sam3.png",
    iconState4: "sprites/SAMPAGUITA/sam4.png",
    iconState5: "sprites/SAMPAGUITA/sam5.png",
  },
  {
    name: "Kalachuchi",
    growthTime: "120000",
    lockedDesc: "Where colors dare to speak louder than words.",
    fullDesc: "Frangipani - in places of farewell, it blossoms, it blooms, it shouts athe whisphers of memories and the last farewells.",
    iconState1: "sprites/KALACHUCHI/kal1.png",
    iconState2: "sprites/KALACHUCHI/kal2.png",
    iconState3: "sprites/KALACHUCHI/kal3.png",
    iconState4: "sprites/KALACHUCHI/kal4.png",
    iconState5: "sprites/KALACHUCHI/kal5.png",
  },
  {
    name: "Sampaguita",
    growthTime: "15000",
    lockedDesc: "Where childhood secrets taste sweet.",
    fullDesc: "Arabian Jasmine - you can never go wrong with Philippines' national flower. Strung into garlands, sold outside churches and jeepney stops, always carrying that distinct scent.",
    iconState1: "sprites/SAMPAGUITA/sam1.png",
    iconState2: "sprites/SAMPAGUITA/sam2.png",
    iconState3: "sprites/SAMPAGUITA/sam3.png",
    iconState4: "sprites/SAMPAGUITA/sam4.png",
    iconState5: "sprites/SAMPAGUITA/sam5.png",
  },
  {
    name: "Kahoy-Dalaga",
    growthTime: "30000",
    lockedDesc: "Where fallen petals still smile.",
    fullDesc: "Mussaenda Philippica - blooms like a constellation brought down to earth, each petal a luminous star resting on emerald skies.",
    iconState1: "sprites/MUSSAENDA/mussa1.png",
    iconState2: "sprites/MUSSAENDA/mussa2.png",
    iconState3: "sprites/MUSSAENDA/mussa3.png",
    iconState4: "sprites/MUSSAENDA/mussa4.png",
    iconState5: "sprites/MUSSAENDA/mussa5.png",
  },
  {
    name: "Mirasol",
    growthTime: "45000",
    lockedDesc: "Where tiny sunshines are met.",
    fullDesc: "Sunflower - a poetic symbolism of Filipinos' perceverance, standing tall always turning its face where the light shines.",
    iconState1: "sprites/SAMPAGUITA/sam1.png",
    iconState2: "sprites/SAMPAGUITA/sam2.png",
    iconState3: "sprites/SAMPAGUITA/sam3.png",
    iconState4: "sprites/SAMPAGUITA/sam4.png",
    iconState5: "sprites/SAMPAGUITA/sam5.png",
  },
];
//grabs growth in ms
function getGrowthMs(flower){
  return Math.max(1, Number(flower?.growthTime) || 0);
}

// pick which flower to grow during each interval
let currentFlower = flowerData[0];

// ---------------------------------------------
// DOM HELPERS & UTILITIES
// ---------------------------------------------
const $ = (id) => document.getElementById(id);
const growthFlower = $("growthFlower");
const progressBar  = $("progressbar");
const flowerEta    = $("flowerEta");

let flowerElapsedMs = 0;
let flowerGrowthMs = getGrowthMs(currentFlower);



function minutesToSeconds(m){ return Math.max(0, Math.round((m || 0) * 60)); }
function formatTime(total){
  total = Math.max(0, total|0);
  const m = Math.floor(total/60);
  const s = total % 60;
  return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}

//ms animation
function stageByPercent(flower, pct){
  pct = Math.min(1, flowerElapsedMs / flowerGrowthMs);
  if (pct < 0.20) return flower.iconState1;
  if (pct < 0.40) return flower.iconState2;
  if (pct < 0.65) return flower.iconState3;
  if (pct < 0.85) return flower.iconState4 || flower.iconState3;
  return flower.iconState5 || flower.iconState4 || flower.iconState3;
}





// SESSION progress only (keep the bar for timer progress)
function refreshGrowthFlower(pct){
  pct = Math.max(0, Math.min(1, pct || 0));
  
}

// FLOWER progress: update just the sprite + ETA
function updateFlowerUI() {
  const pct = Math.min(1, flowerElapsedMs / flowerGrowthMs);
  growthFlower.src = stageByPercent(currentFlower, pct);
  growthFlower.alt = `${currentFlower.name} growth ${Math.round(pct*100)}%`;
  progressBar.value = pct * 100;

  if (!flowerEta) return;
  if (pct >= 1) {
    flowerEta.textContent = "Flower grown!";
  } else if (mode !== 'work') {
    // Show that growth is paused during breaks
    flowerEta.textContent = "Growth resumes in Work mode";
  } else {
    const minsLeft = Math.ceil((flowerGrowthMs - flowerElapsedMs) / 60000);
    flowerEta.textContent = `${Math.max(0, minsLeft)} min until grown`;
  }
}

function resetFlower() {
  flowerElapsedMs = 0;
  flowerGrowthMs = Math.max(1, Number((currentFlower && currentFlower.growthTime) || 0));
  updateFlowerUI();
}

// ---------------------------------------------
// TIMER STATE
// ---------------------------------------------
let timer = null;
let isPaused = true;

// durations (seconds)
let workSeconds   = 25 * 60;
let shortSeconds  = 5 * 60;
let longSeconds   = 15 * 60;

// how many short breaks between long ones
let maxShortsBeforeLong = 4; // after 4 work sessions, take a long break

// runtime counters
let totalSeconds = workSeconds;         // remaining seconds in current interval
let intervalTotalSeconds = workSeconds; // fixed length of the current interval
let shortBreaksTaken = 0;               // increments after finishing a short break cycle

// current mode: 'work' | 'short' | 'long'
let mode = 'work';

function updateCounter(){ $('counter').innerText = formatTime(totalSeconds); }
function updateModeLabel(){ $('modeLabel').innerText = `Mode: ${mode[0].toUpperCase()}${mode.slice(1)}`; }

function computeIntervalPercent(){
  const elapsed = Math.max(0, intervalTotalSeconds - totalSeconds);
  const pct = elapsed / Math.max(1, intervalTotalSeconds);
  return Math.max(0, Math.min(1, pct));
}

function setMode(nextMode, setFreshTime = true){
  mode = nextMode;
  updateModeLabel();

  if (setFreshTime){
    if (mode === 'work')  totalSeconds = workSeconds;
    if (mode === 'short') totalSeconds = shortSeconds;
    if (mode === 'long')  totalSeconds = longSeconds;
  }

  // reset the interval baseline whenever the mode changes
  intervalTotalSeconds = Math.max(1, totalSeconds);
  updateCounter();

  // reset session progress bar at the start of a new interval
  refreshGrowthFlower(0);
}

function clearTick(){ if (timer != null){ clearInterval(timer); timer = null; } }

function tick(){
  if (isPaused) return;
  totalSeconds -= 1;
  updateCounter();

  // Session progress (progress bar)
  refreshGrowthFlower(computeIntervalPercent());

  // Flower grows during WORK only (1s per tick)
  if (mode === 'work') {
    flowerElapsedMs = Math.min(flowerGrowthMs, flowerElapsedMs + 1000);
    updateFlowerUI();
  }

  if (totalSeconds <= 0){
    clearTick();
    onIntervalFinished();
  }
}



function startCountdown(){
  const durationForMode = (mode === 'work') ? workSeconds : (mode === 'short' ? shortSeconds : longSeconds);
  if (durationForMode <= 0){
    alert('Please set durations greater than 0 minutes.');
    return;
  }

  if (totalSeconds <= 0) setMode(mode, true);

  isPaused = false;
  clearTick();
  updateCounter();

  // Make sure the session bar reflects the current starting point
  refreshGrowthFlower(computeIntervalPercent());
  

  timer = setInterval(tick, 1000);
}

function pauseResume() {
  isPaused = !isPaused;
  document.getElementById('pause-label').textContent = isPaused ? 'Resume' : 'Pause';

  if (!isPaused && timer == null) {
    timer = setInterval(tick, 1000);
  }
}

function resetTimer(){
  clearTick();
  isPaused = true;
  setMode('work', true);
  shortBreaksTaken = 0;
  // do not reset flower here unless you want to start plant over
}

function onIntervalFinished(){
  // choose next mode and auto-start it
  if (mode === 'work'){
    if ((shortBreaksTaken + 1) >= maxShortsBeforeLong){
      setMode('long', true);
      shortBreaksTaken = 0;
    } else {
      setMode('short', true);
      shortBreaksTaken += 1;
    }
  } else {
    setMode('work', true);
  }
  startCountdown();
}

// ---------- Settings ----------
$('set-btn').onclick = function(){
  const w  = $('worktime').valueAsNumber;
  const sb = $('sBreak').valueAsNumber;
  const lb = $('lBreak').valueAsNumber;
  const bc = $('bMaxCounter').valueAsNumber;

  workSeconds  = minutesToSeconds(Number.isFinite(w)  ? w  : 25);
  shortSeconds = minutesToSeconds(Number.isFinite(sb) ? sb : 5);
  longSeconds  = minutesToSeconds(Number.isFinite(lb) ? lb : 15);
  maxShortsBeforeLong = Math.max(1, Math.floor(Number.isFinite(bc) ? bc : 4));

  // Keep current mode but refresh remaining time to match new settings
  setMode(mode, true);

  $('timeSet').innerText =
`Work Time: ${Math.floor(workSeconds/60)} min
Short Break: ${Math.floor(shortSeconds/60)} min
Long Break: ${Math.floor(longSeconds/60)} min
Shorts before Long: ${maxShortsBeforeLong}`;
};

// ---------- Button bindings ----------
$('start-btn').onclick = startCountdown;
$('pause-btn').onclick = pauseResume;
$('reset-btn').onclick = resetTimer;

// ---------- Initial UI ----------
updateModeLabel();
updateCounter();
refreshGrowthFlower(0);
resetFlower();
</script>

</html>